<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>K-Vibe Shop — Корейская мода</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<style>
body { font-family:'Poppins',sans-serif; margin:0; background:#f5f5f5; color:#222; }
header { background:linear-gradient(135deg,#ff4d6d,#ff9a9e); color:#fff; text-align:center; padding:50px 20px; }
header h1 { font-size:clamp(20px,6vw,36px); margin:0; font-weight:700; }
header p { font-size:clamp(16px,4vw,22px); margin-top:10px; }

.container { display:flex; max-width:1200px; margin:auto; padding:20px; gap:20px; align-items:flex-start; }
.left { flex:1 1 200px; position:sticky; top:20px; max-height:calc(100vh - 40px); overflow-y:auto; padding:15px; background:#f5f5f5; border-radius:12px; }
.right { flex:3 1 600px; }

h2 { color:#ff4d6d; margin:20px 0 10px 0; }
.categories, .products, .cart-items { display:grid; grid-template-columns:1fr; gap:15px; scroll-behavior: smooth; }
.category, .product, .cart-item { background:#fff; padding:15px; border-radius:12px; box-shadow:0 3px 6px rgba(0,0,0,0.1); text-align:center; }
.category i, .product i { font-size:40px; margin-bottom:10px; color:#ff4d6d; }
.category img, .product img { max-width:60px; margin-bottom:10px; }
.product h3, .cart-item h4 { margin:5px 0; }
.product p, .cart-item p { font-size:14px; margin:3px 0; }
.cart-total { font-weight:bold; margin-top:10px; text-align:right; }
input, select { width:95%; padding:10px; margin:8px 0; border-radius:10px; border:1px solid #ccc; }
button { background:#ff4d6d; color:#fff; border:none; padding:10px 16px; border-radius:10px; cursor:pointer; margin-top:5px; }
button:hover { background:#ff2e55; }
#user-status { margin-top:10px; font-weight:bold; }
.edit-btn { margin-top:5px; font-size:12px; background:#ffa3b1; }
.edit-btn:hover { background:#ff7b89; }
.delete-btn { margin-top:5px; font-size:12px; background:#ff7b89; }
.delete-btn:hover { background:#ff4d6d; }

/* Мобильные стили */
@media(max-width:800px){
  .container { flex-direction:column; }
  .left, .right { width:100%; }
  .left { order:1; position:sticky; top:0; z-index:1000; border-radius:0; overflow-y:visible; }
  .right { order:2; }

  /* Сворачиваемая админка */
  .admin-section { margin-top:10px; background:#fff; padding:10px; border-radius:10px; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
  .admin-toggle-btn { display:block; width:100%; margin-top:10px; padding:10px; background:#ff4d6d; color:#fff; border:none; border-radius:10px; cursor:pointer; font-weight:bold; text-align:left; }
  .admin-toggle-btn:hover { background:#ff2e55; }

  /* Анимация раскрытия */
  .admin-section #admin-content {
    overflow: hidden;
    max-height: 0;
    transition: max-height 0.3s ease, padding 0.3s ease;
    padding-top:0;
    padding-bottom:0;
  }
  .admin-section.open #admin-content {
    max-height: 1000px;
    padding-top:10px;
    padding-bottom:10px;
  }
}
</style>
</head>
<body>

<header>
<h1>СТИЛЬ АЙДОЛОВ: Трендовая корейская мода для тебя ♡</h1>
<p>С доставкой в Россию!</p>
</header>

<div class="container">
<div class="left">
  <h2>Категории</h2>
  <div id="categories" class="categories"></div>

  <h2>Корзина</h2>
  <div id="cart-items" class="cart-items">Корзина пуста</div>
  <div class="cart-total" id="cart-total"></div>
  <button onclick="checkout()">Оформить заказ</button>

  <div id="login-section" style="display:none;">
    <h2>Вход / Регистрация</h2>
    <input id="reg-email" type="email" placeholder="Email">
    <input id="reg-pass" type="password" placeholder="Пароль">
    <button type="button" onclick="register()">Зарегистрироваться</button>
    <button type="button" onclick="login()">Войти</button>
    <p id="user-status">Вы не вошли</p>
  </div>

  <!-- Админский блок -->
  <div class="admin-section" id="admin-panel" style="display:none;">
    <button class="admin-toggle-btn" onclick="toggleAdminMobile()">
      Админ: показать/скрыть <i id="toggle-icon" class="fa-solid fa-chevron-down"></i>
    </button>
    <div id="admin-content">
      <h3>Добавить категорию</h3>
      <input id="new-cat-name" placeholder="Название категории">
      <input id="new-cat-icon" placeholder="Класс иконки (fa-solid fa-shirt)">
      <input id="new-cat-img" type="file" accept="image/*">
      <button type="button" onclick="addCategory()">Добавить категорию</button>

      <h3>Добавить товар</h3>
      <input id="new-prod-name" placeholder="Название">
      <input id="new-prod-price" placeholder="Цена">
      <input id="new-prod-desc" placeholder="Описание">
      <select id="new-prod-cat"></select>
      <input id="new-prod-icon" placeholder="Класс иконки (fa-solid fa-bag-shopping)">
      <input id="new-prod-img" type="file" accept="image/*">
      <button type="button" onclick="addProduct()">Добавить товар</button>
    </div>
  </div>
</div>

<div class="right">
  <h2>Товары</h2>
  <div id="products-list" class="products"></div>
</div>
</div>

<script>
// ===== Пользователи =====
let users = JSON.parse(localStorage.getItem('users')||'{}');
let currentUser = localStorage.getItem('currentUser')||null;
const adminEmail = "annaaguara@gmail.com";

function saveUsers(){ localStorage.setItem('users',JSON.stringify(users)); }
function register(){ 
  let email=document.getElementById('reg-email').value.trim();
  let pass=document.getElementById('reg-pass').value.trim();
  if(!email||!pass){ alert("Введите email и пароль!"); return; }
  if(users[email]){ alert("Пользователь существует!"); return; }
  users[email]={password:pass}; saveUsers(); alert("Регистрация успешна!"); login(); 
}
function login(){ 
  let email=document.getElementById('reg-email').value.trim();
  let pass=document.getElementById('reg-pass').value.trim();
  if(users[email]&&users[email].password===pass){
    currentUser=email; localStorage.setItem('currentUser',email); updateStatus();
  } else alert("Неверный логин или пароль!");
}
function logout(){ currentUser=null; localStorage.removeItem('currentUser'); updateStatus(); }
function updateStatus(){
  const status=document.getElementById('user-status');
  const adminPanel=document.getElementById('admin-panel');
  const loginSection=document.getElementById('login-section');
  if(currentUser){
    status.innerText="Вы вошли как: "+currentUser; status.style.color="green";
    adminPanel.style.display=(currentUser===adminEmail)?"block":"none";
    loginSection.style.display="none";
  } else { status.innerText="Вы не вошли"; status.style.color="red"; loginSection.style.display="block"; adminPanel.style.display="none"; }
}
updateStatus();

// ===== Категории и товары =====
let categories=JSON.parse(localStorage.getItem('categories')||'[]');
let products=JSON.parse(localStorage.getItem('products')||'[]');
let cart=[];

// Дефолтные категории
if(categories.length===0){
  categories=[{name:"Сумки",icon:"fa-solid fa-bag-shopping",img:null},{name:"Штаны",icon:"fa-solid fa-user-tie",img:null},{name:"Футболки",icon:"fa-solid fa-shirt",img:null},{name:"Кепки",icon:"fa-solid fa-hat-cowboy",img:null}];
}

function saveData(){ 
  localStorage.setItem('categories',JSON.stringify(categories)); 
  localStorage.setItem('products',JSON.stringify(products)); 
  renderCategories(); 
  renderProducts(); 
  populateCategories(); 
  renderCart(); 
}

// ===== Админ функции =====
function addCategory(){
  if(currentUser!==adminEmail){ alert("Только админ!"); return; }
  const name=document.getElementById('new-cat-name').value;
  const icon=document.getElementById('new-cat-icon').value;
  const file=document.getElementById('new-cat-img').files[0];
  if(!name){ alert("Введите название категории!"); return; }
  if(icon){ categories.push({name,icon,img:null}); saveData(); }
  else if(file){ const reader=new FileReader(); reader.onload=e=>{ categories.push({name,icon:null,img:e.target.result}); saveData(); }; reader.readAsDataURL(file); }
  else alert("Добавьте иконку или картинку!");
}

function addProduct(){
  if(currentUser!==adminEmail){ alert("Только админ!"); return; }
  const name=document.getElementById('new-prod-name').value;
  const price=document.getElementById('new-prod-price').value;
  const desc=document.getElementById('new-prod-desc').value;
  const cat=document.getElementById('new-prod-cat').value;
  const icon=document.getElementById('new-prod-icon').value;
  const file=document.getElementById('new-prod-img').files[0];
  if(!name||!price||!cat){ alert("Заполните все поля!"); return; }
  if(icon){ products.push({name,price,desc,category:cat,icon,img:null}); saveData(); }
  else if(file){ const reader=new FileReader(); reader.onload=e=>{ products.push({name,price,desc,category:cat,icon:null,img:e.target.result}); saveData(); }; reader.readAsDataURL(file); }
  else alert("Добавьте иконку или картинку!");
}

// ===== Рендер =====
function renderCategories(){ 
  const container=document.getElementById('categories'); 
  container.innerHTML=''; 
  categories.forEach((cat,i)=>{
    const div=document.createElement('div'); 
    div.className='category'; 
    if(cat.icon){ const iTag=document.createElement('i'); iTag.className=cat.icon; div.appendChild(iTag); } 
    else if(cat.img){ const img=document.createElement('img'); img.src=cat.img; div.appendChild(img); } 
    const name=document.createElement('h3'); name.innerText=cat.name; div.appendChild(name); 
    if(currentUser===adminEmail){ 
      const editBtn=document.createElement('button'); editBtn.className='edit-btn'; editBtn.innerText='Редактировать'; editBtn.onclick=()=>editCategory(i); div.appendChild(editBtn); 
      const delBtn=document.createElement('button'); delBtn.className='delete-btn'; delBtn.innerText='Удалить'; delBtn.onclick=()=>deleteCategory(i); div.appendChild(delBtn); 
    } 
    container.appendChild(div); 
  }); 
}

function renderProducts(){ 
  const container=document.getElementById('products-list'); 
  container.innerHTML=''; 
  products.forEach((p,i)=>{
    const div=document.createElement('div'); 
    div.className='product'; 
    if(p.icon){ const iTag=document.createElement('i'); iTag.className=p.icon; div.appendChild(iTag); } 
    else if(p.img){ const img=document.createElement('img'); img.src=p.img; div.appendChild(img); } 
    const name=document.createElement('h3'); name.innerText=p.name; div.appendChild(name); 
    const price=document.createElement('p'); price.innerText=p.price+" ₽"; div.appendChild(price); 
    container.appendChild(div); 
  }); 
}

function populateCategories(){
  const select=document.getElementById('new-prod-cat');
  select.innerHTML='';
  categories.forEach(cat=>{
    const opt=document.createElement('option'); opt.value=cat.name; opt.innerText=cat.name; select.appendChild(opt);
  });
}

// ===== Сворачивание админки на мобилках с анимацией =====
function toggleAdminMobile(){
  const adminSection = document.getElementById('admin-panel');
  adminSection.classList.toggle('open');
  // Меняем иконку стрелки
  const icon = document.getElementById('toggle-icon');
  if(adminSection.classList.contains('open')) icon.className='fa-solid fa-chevron-up';
  else icon.className='fa-solid fa-chevron-down';
}

// ===== Инициализация =====
document.addEventListener('DOMContentLoaded',()=>{
  renderCategories();
  renderProducts();
  populateCategories();
  if(window.innerWidth<=800){
    const content=document.getElementById('admin-content');
    if(content) content.style.display='block'; // Чтобы CSS анимация работала
  }
});

// ===== Пустые функции для корзины и checkout =====
function renderCart(){ document.getElementById('cart-items').innerText = cart.length ? cart.map(p=>p.name).join(", ") : "Корзина пуста"; }
function checkout(){ alert("Оформление заказа"); }
function editCategory(i){ alert("Редактировать
