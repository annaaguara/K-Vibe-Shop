<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>K-Vibe Shop — Корейская мода</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body { font-family:'Poppins',sans-serif; margin:0; background:#f5f5f5; color:#222; }
* { box-sizing:border-box; }
/* === Верхняя панель === */
.topbar {
  position:fixed; top:0; left:0; width:100%; background:linear-gradient(135deg,#ff4d6d,#ff9a9e);
  color:#fff; display:flex; justify-content:space-between; align-items:center; padding:10px 20px; z-index:1000;
  box-shadow:0 2px 8px rgba(0,0,0,0.15);
}
.topbar h1 { font-size:clamp(18px,5vw,28px); margin:0; font-weight:700; }
.topbar .top-right { display:flex; align-items:center; gap:15px; position:relative; }
.topbar button { background:rgba(255,255,255,0.2); border:none; color:#fff; padding:6px 12px; border-radius:8px; cursor:pointer; }
.topbar button:hover { background:rgba(255,255,255,0.35); }
.topbar .cart-count { background:#fff; color:#ff4d6d; font-weight:bold; padding:2px 6px; border-radius:50%; font-size:12px; position:absolute; top:-5px; right:-5px; }

/* === Контейнер === */
.container { display:flex; max-width:1200px; margin:80px auto 20px auto; padding:0 20px; gap:20px; }
.left { flex:1 1 220px; background:#fff; padding:15px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.1); }
.right { flex:3 1 600px; }

h2 { color:#ff4d6d; margin:15px 0 10px 0; }
.categories, .products { display:grid; grid-template-columns:1fr; gap:15px; }
.category, .product { background:#fff; padding:15px; border-radius:12px; box-shadow:0 3px 6px rgba(0,0,0,0.1); text-align:center; }
.category i, .product i { font-size:40px; margin-bottom:10px; color:#ff4d6d; }
.product h3 { margin:5px 0; }
.product p { font-size:14px; margin:3px 0; }
button.add-to-cart { background:#ff4d6d; color:#fff; border:none; padding:10px 16px; border-radius:10px; cursor:pointer; margin-top:5px; }
button.add-to-cart:hover { background:#ff2e55; }

/* === Модальные окна === */
.modal {
  display:none; position:fixed; z-index:2000; left:0; top:0; width:100%; height:100%; overflow:auto;
  background-color:rgba(0,0,0,0.5); padding-top:60px;
}
.modal-content {
  background-color:#fff; margin:5% auto; padding:20px; border-radius:12px; width:90%; max-width:500px; position:relative;
}
.close { color:#aaa; float:right; font-size:28px; font-weight:bold; cursor:pointer; position:absolute; top:10px; right:20px; }
.close:hover { color:#000; }
input, select { width:95%; padding:10px; margin:5px 0; border-radius:10px; border:1px solid #ccc; }
button { margin-top:5px; }
@media(max-width:800px){
  .container { flex-direction:column; }
  .left, .right { width:100%; }
  .categories, .products { grid-template-columns:1fr 1fr; }
  .category i, .product i { font-size:30px; }
}
@media(max-width:500px){
  .categories, .products { grid-template-columns:1fr; }
}
</style>
</head>
<body>

<div class="topbar">
  <h1>K-Vibe Shop</h1>
  <div class="top-right">
    <div style="position:relative;">
      <button id="cart-btn"><i class="fa-solid fa-cart-shopping"></i></button>
      <span class="cart-count" id="cart-count">0</span>
    </div>
    <div id="user-buttons">
      <button id="login-btn">Вход / Регистрация</button>
    </div>
  </div>
</div>

<div class="container">
  <div class="left">
    <h2>Категории</h2>
    <div id="categories" class="categories"></div>
    <button id="admin-btn" style="display:none;">Админ панель</button>
  </div>
  <div class="right">
    <h2>Товары</h2>
    <div id="products-list" class="products"></div>
  </div>
</div>

<!-- Модалки -->
<div id="cart-modal" class="modal">
  <div class="modal-content">
    <span class="close" id="close-cart">&times;</span>
    <h2>Корзина</h2>
    <div id="cart-items">Корзина пуста</div>
    <div class="cart-total" id="cart-total"></div>
    <button onclick="checkout()">Оформить заказ</button>
  </div>
</div>

<div id="login-modal" class="modal">
  <div class="modal-content">
    <span class="close" id="close-login">&times;</span>
    <h2>Регистрация / Вход</h2>
    <input id="reg-email" type="email" placeholder="Email"><br>
    <input id="reg-pass" type="password" placeholder="Пароль"><br>
    <button id="register-btn">Зарегистрироваться</button>
    <button id="login-submit-btn">Войти</button>
    <p id="user-status">Вы не вошли</p>
  </div>
</div>

<div id="admin-modal" class="modal">
  <div class="modal-content">
    <span class="close" id="close-admin">&times;</span>
    <h2>Админка</h2>
    
    <h3>Категории</h3>
    <div id="admin-categories"></div>
    <input id="new-cat-name" placeholder="Название категории">
    <select id="new-cat-icon"></select>
    <button onclick="addCategory()">Добавить категорию</button>
    
    <h3>Товары</h3>
    <div id="admin-products"></div>
    <input id="new-prod-name" placeholder="Название">
    <input id="new-prod-price" placeholder="Цена">
    <input id="new-prod-desc" placeholder="Описание">
    <select id="new-prod-cat"></select>
    <select id="new-prod-icon"></select>
    <button onclick="addProduct()">Добавить товар</button>
  </div>
</div>

<script>
// ===== Пользователи =====
const adminEmail = "annaaguara@gmail.com";
let users = JSON.parse(localStorage.getItem('users')||'{}');
let currentUser = localStorage.getItem('currentUser') || null;

// ===== Модалки =====
function openModal(id){ document.getElementById(id).style.display='block'; }
function closeModal(id){ document.getElementById(id).style.display='none'; }
document.getElementById('login-btn').onclick = ()=>openModal('login-modal');
document.getElementById('cart-btn').onclick = ()=>openModal('cart-modal');
document.getElementById('admin-btn').onclick = ()=>openModal('admin-modal');
document.getElementById('close-login').onclick = ()=>closeModal('login-modal');
document.getElementById('close-cart').onclick = ()=>closeModal('cart-modal');
document.getElementById('close-admin').onclick = ()=>closeModal('admin-modal');
window.onclick = function(event){
  ['login-modal','cart-modal','admin-modal'].forEach(id=>{
    const modal = document.getElementById(id);
    if(event.target==modal) modal.style.display='none';
  });
}

// ===== Обновление статуса =====
function updateStatus(){
  const status = document.getElementById('user-status');
  const userButtons = document.getElementById('user-buttons');
  const adminBtn = document.getElementById('admin-btn');
  if(currentUser){
    status.innerHTML=`Вы вошли как: <b>${currentUser}</b>`;
    userButtons.innerHTML=`<span style="color:#fff;">${currentUser}</span> <button onclick="logout()">Выйти</button>`;
    if(currentUser===adminEmail) adminBtn.style.display='block';
  } else {
    status.innerText="Вы не вошли";
    userButtons.innerHTML=`<button onclick="openModal('login-modal')">Вход / Регистрация</button>`;
    adminBtn.style.display='none';
  }
}
updateStatus();

// ===== Регистрация и вход =====
document.getElementById('register-btn').onclick = function(){
  const email=document.getElementById('reg-email').value.trim();
  const pass=document.getElementById('reg-pass').value.trim();
  if(!email||!pass){ alert("Введите email и пароль"); return; }
  if(users[email]){ alert("Пользователь уже существует"); return; }
  users[email]={password:pass};
  localStorage.setItem('users',JSON.stringify(users));
  alert("Регистрация успешна");
  loginUser(email);
};
document.getElementById('login-submit-btn').onclick = function(){
  const email=document.getElementById('reg-email').value.trim();
  const pass=document.getElementById('reg-pass').value.trim();
  if(users[email]&&users[email].password===pass) loginUser(email);
  else alert("Неверный логин или пароль");
};
function loginUser(email){
  currentUser=email;
  localStorage.setItem('currentUser',currentUser);
  updateStatus();
  closeModal('login-modal');
}
function logout(){
  currentUser=null;
  localStorage.removeItem('currentUser');
  updateStatus();
}

//
