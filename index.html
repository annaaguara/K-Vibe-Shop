<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>K-Vibe Shop</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body {
    margin:0;
    font-family:'Poppins',sans-serif;
    background:#f5f5f5;
    color:#222;
}
.topbar{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:10px 20px;
    background:linear-gradient(135deg,#ff4d6d,#ff9a9e);
    color:#fff;
    position:fixed;
    width:100%;
    top:0;
    z-index:1000;
}
.topbar h1{margin:0;font-size:clamp(18px,5vw,28px);}
.top-right{display:flex;align-items:center;gap:10px;position:relative;}
.top-right button{background:rgba(255,255,255,0.2);border:none;color:#fff;padding:5px 10px;border-radius:8px;cursor:pointer;}
.cart-count{background:#fff;color:#ff4d6d;font-weight:bold;padding:2px 6px;border-radius:50%;font-size:12px;position:absolute;top:-5px;right:-5px;}
.container{display:flex;flex-wrap:wrap;max-width:1200px;margin:80px auto 20px;padding:0 20px;gap:20px;}
.left{flex:1 1 220px;background:#fff;padding:15px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.1);}
.right{flex:3 1 600px;}
h2{color:#ff4d6d;margin:10px 0;}
.categories,.products{display:grid;grid-template-columns:1fr;gap:10px;}
.category,.product{
    background:#fff;
    padding:10px;
    border-radius:10px;
    box-shadow:0 2px 6px rgba(0,0,0,0.1);
    text-align:center;
    cursor:pointer;
    position:relative;
    transition:0.2s;
    touch-action: manipulation;
}
.category:hover,.product:hover{transform:scale(1.03);}
.category img,.product img{width:60px;height:60px;margin-bottom:5px;object-fit:contain;}
button.add-to-cart{background:#ff4d6d;color:#fff;border:none;padding:6px 10px;border-radius:8px;cursor:pointer;transition:0.2s;}
button.add-to-cart:hover{background:#ff2e55;}
.delete-btn{position:absolute;top:5px;right:5px;background:#ff2e55;color:#fff;border:none;padding:2px 5px;border-radius:5px;font-size:12px;cursor:pointer;transition:0.2s;}
.delete-btn:hover{background:#ff1a3d;}
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:2000;overflow:auto;}
.modal-content{background:#fff;margin:10% auto;padding:20px;border-radius:12px;width:90%;max-width:400px;position:relative;overflow-y:auto;max-height:80vh;-webkit-overflow-scrolling:touch;}
.close{position:absolute;top:10px;right:15px;font-size:25px;font-weight:bold;color:#aaa;cursor:pointer;}
.close:hover{color:#000;}
input,select{width:95%;padding:8px;margin:5px 0;border-radius:8px;border:1px solid #ccc;}
.icon-select{display:grid;grid-template-columns:repeat(4,1fr);gap:5px;margin:5px 0;}
.icon-select img{width:60px;height:60px;margin:5px;cursor:pointer;border:2px solid transparent;border-radius:8px;transition:0.2s;object-fit:contain;}
.icon-select img.selected{border-color:#ff4d6d;transform:scale(1.2);}
@media(max-width:800px){
    .container{flex-direction:column;}
    .categories,.products{grid-template-columns:1fr 1fr;}
}
@media(max-width:500px){
    .categories,.products{grid-template-columns:1fr;}
    .icon-select{grid-template-columns:repeat(3,1fr);}
}
</style>
</head>
<body>

<div class="topbar">
<h1>K-Vibe Shop</h1>
<div class="top-right">
  <button id="cart-btn">–ö–æ—Ä–∑–∏–Ω–∞ üõí <span class="cart-count" id="cart-count">0</span></button>
  <div id="user-buttons"><button id="login-btn">–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button></div>
</div>
</div>

<div class="container">
<div class="left">
<h2>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>
<div id="categories" class="categories"></div>
<button id="admin-btn" style="display:none;">–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</button>
</div>
<div class="right">
<h2>–¢–æ–≤–∞—Ä—ã</h2>
<div id="products-list" class="products"></div>
</div>
</div>

<!-- –ú–æ–¥–∞–ª–∫–∏ -->
<div id="cart-modal" class="modal">
<div class="modal-content">
<span class="close" id="close-cart">&times;</span>
<h2>–ö–æ—Ä–∑–∏–Ω–∞</h2>
<div id="cart-items">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</div>
<div id="cart-total"></div>
<button onclick="checkout()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
</div>
</div>

<div id="login-modal" class="modal">
<div class="modal-content">
<span class="close" id="close-login">&times;</span>
<h2>–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
<input id="reg-email" type="email" placeholder="Email">
<input id="reg-pass" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
<button id="register-btn">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
<button id="login-submit-btn">–í–æ–π—Ç–∏</button>
<p id="user-status">–í—ã –Ω–µ –≤–æ—à–ª–∏</p>
</div>
</div>

<div id="admin-modal" class="modal">
<div class="modal-content">
<span class="close" id="close-admin">&times;</span>
<h2>–ê–¥–º–∏–Ω–∫–∞</h2>

<h3>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
<div id="admin-categories"></div>
<input id="new-cat-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏">
<div class="icon-select" id="new-cat-icons"></div>
<button onclick="addCategory()">–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>

<h3>–¢–æ–≤–∞—Ä—ã</h3>
<div id="admin-products"></div>
<input id="new-prod-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
<input id="new-prod-price" placeholder="–¶–µ–Ω–∞">
<input id="new-prod-desc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ">
<select id="new-prod-cat"></select>
<div class="icon-select" id="new-prod-icons"></div>
<button onclick="addProduct()">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
</div>
</div>

<script>
const adminEmail="annaaguara@gmail.com";
let users=JSON.parse(localStorage.getItem('users')||'{}');
let currentUser=localStorage.getItem('currentUser')||null;
let categories=JSON.parse(localStorage.getItem('categories')||'[]');
let products=JSON.parse(localStorage.getItem('products')||'[]');
let cart=JSON.parse(localStorage.getItem('cart')||'[]');

const iconOptions=[
"https://i.postimg.cc/tJXQmD4t/bag.png",
"https://i.postimg.cc/1Xt4FV4F/shirt.png",
"https://i.postimg.cc/mkZV5Hfh/hat.png",
"https://i.postimg.cc/7Y6H6h5H/pants.png",
"https://i.postimg.cc/bJ8m7FqS/shoes.png",
"https://i.postimg.cc/Hsxn3fYY/dress.png",
"https://i.postimg.cc/dVwDfp2x/jacket.png",
"https://i.postimg.cc/Qxg6Yq7Y/skirt.png"
];

function openModal(id){document.getElementById(id).style.display='block';}
function closeModal(id){document.getElementById(id).style.display='none';}
document.getElementById('login-btn').onclick=()=>openModal('login-modal');
document.getElementById('cart-btn').onclick=()=>{renderCart(); openModal('cart-modal');};
document.getElementById('admin-btn').onclick=()=>{populateProdCatSelect(); setupIconSelect('new-cat-icons'); setupIconSelect('new-prod-icons'); renderAdminCategories(); renderAdminProducts(); openModal('admin-modal');};
document.getElementById('close-login').onclick=()=>closeModal('login-modal');
document.getElementById('close-cart').onclick=()=>closeModal('cart-modal');
document.getElementById('close-admin').onclick=()=>closeModal('admin-modal');
window.onclick=function(e){['login-modal','cart-modal','admin-modal'].forEach(id=>{if(e.target==document.getElementById(id)) closeModal(id);});}

function updateStatus(){
const status=document.getElementById('user-status');
const userButtons=document.getElementById('user-buttons');
const adminBtn=document.getElementById('admin-btn');
if(currentUser){
status.innerHTML=`–í—ã –≤–æ—à–ª–∏ –∫–∞–∫: <b>${currentUser}</b>`;
userButtons.innerHTML=`<span style="color:#fff;">${currentUser}</span> <button onclick="logout()">–í—ã–π—Ç–∏</button>`;
adminBtn.style.display=(currentUser===adminEmail)?'block':'none';
} else {
status.innerText="–í—ã –Ω–µ –≤–æ—à–ª–∏";
userButtons.innerHTML=`<button onclick="openModal('login-modal')">–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>`;
adminBtn.style.display='none';
}}
updateStatus();

document.getElementById('register-btn').onclick=function(){
const email=document.getElementById('reg-email').value.trim();
const pass=document.getElementById('reg-pass').value.trim();
if(!email||!pass){alert("–í–≤–µ–¥–∏—Ç–µ email –∏ –ø–∞—Ä–æ–ª—å");return;}
if(users[email]){alert("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç");return;}
users[email]={password:pass}; localStorage.setItem('users',JSON.stringify(users)); loginUser(email);
};
document.getElementById('login-submit-btn').onclick=function(){
const email=document.getElementById('reg-email').value.trim();
const pass=document.getElementById('reg-pass').value.trim();
if(users[email]&&users[email].password===pass) loginUser(email);
else alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å");
};
function loginUser(email){currentUser=email;localStorage.setItem('currentUser',currentUser);updateStatus();closeModal('login-modal');}
function logout(){currentUser=null;localStorage.removeItem('currentUser');updateStatus();}

if(categories.length===0){
categories=[
{name:"–°—É–º–∫–∏",icon:iconOptions[0]},
{name:"–§—É—Ç–±–æ–ª–∫–∏",icon:iconOptions[1]},
{name:"–ö–µ–ø–∫–∏",icon:iconOptions[2]},
{name:"–®—Ç–∞–Ω—ã",icon:iconOptions[3]}
];
}
if(products.length===0){
products=[
{name:"–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Å—É–º–∫–∞",price:1500,desc:"–°—Ç–∏–ª—å–Ω–∞—è —Å—É–º–∫–∞",category:"–°—É–º–∫–∏",icon:iconOptions[0]},
{name:"–§—É—Ç–±–æ–ª–∫–∞ K-Pop",price:800,desc:"–ú–æ–¥–Ω–∞—è —Ñ—É—Ç–±–æ–ª–∫–∞",category:"–§—É—Ç–±–æ–ª–∫–∏",icon:iconOptions[1]}
];
}

function renderCategories(){
const container=document.getElementById('categories'); container.innerHTML='';
categories.forEach((cat)=>{
const div=document.createElement('div'); div.className='category';
const img=document.createElement('img'); img.src=cat.icon; div.appendChild(img);
const name=document.createElement('h3'); name.innerText=cat.name; div.appendChild(name);
div.onclick=()=>filterProducts(cat.name);
container.appendChild(div);
});
}

function renderProducts(filter=null){
const container=document.getElementById('products-list'); container.innerHTML='';
products.forEach((p)=>{
if(filter && p.category!==filter) return;
const div=document.createElement('div'); div.className='product';
const img=document.createElement('img'); img.src=p.icon; div.appendChild(img);
const name=document.createElement('h3'); name.innerText=p.name; div.appendChild(name);
const price=document.createElement('p'); price.innerText=p.price+" ‚ÇΩ"; div.appendChild(price);
const btn=document.createElement('button'); btn.className='add-to-cart'; btn.innerText='–í –∫–æ—Ä–∑–∏–Ω—É';
btn.onclick=()=>{cart.push(p); saveCart();};
div.appendChild(btn);
container.appendChild(div);
});
}

function filterProducts(catName){renderProducts(catName);}

function renderCart(){
const cartDiv=document.getElementById('cart-items');
const totalDiv=document.getElementById('cart-total');
cartDiv.innerHTML='';
if(cart.length===0){cartDiv.innerText="–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞";totalDiv.innerText="";document.getElementById('cart-count').innerText=0;return;}
let total=0;
cart.forEach((item,i)=>{
const div=document.createElement('div');
div.innerHTML=`${item.name} - ${item.price} ‚ÇΩ <button class="delete-btn">x</button>`;
div.querySelector('button').onclick=()=>{cart.splice(i,1);saveCart();};
cartDiv.appendChild(div);
total+=item.price;
});
totalDiv.innerText="–ò—Ç–æ–≥–æ: "+total+" ‚ÇΩ";
document.getElementById('cart-count').innerText=cart.length;
}

function saveCart(){localStorage.setItem('cart',JSON.stringify(cart)); renderCart();}

function checkout(){if(cart.length===0){alert("–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞!");return;} alert("–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞: "+cart.map(i=>i.name).join(", ")); cart=[]; saveCart(); closeModal('cart-modal');}

function populateProdCatSelect(){
const sel=document.getElementById('new-prod-cat'); sel.innerHTML='';
categories.forEach(c=>{let opt=document.createElement('option'); opt.value=c.name; opt.innerText=c.name; sel.appendChild(opt);});
}

function setupIconSelect(containerId){
const container=document.getElementById(containerId); container.innerHTML='';
iconOptions.forEach(icon=>{
const img=document.createElement('img'); img.src=icon;
img.onclick=()=>{container.querySelectorAll('img').forEach(i=>i.classList.remove('selected')); img.classList.add('selected');};
container.appendChild(img);
});
}

function addCategory(){
const name=document.getElementById('new-cat-name').value.trim();
const selIcon=document.querySelector('#new-cat-icons img.selected');
if(!name||!selIcon){alert("–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –∏–∫–æ–Ω–∫—É"); return;}
categories.push({name:name,icon:selIcon.src});
document.getElementById('new-cat-name').value='';
saveData();
alert("–ö–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞");
}

function addProduct(){
const name=document.getElementById('new-prod-name').value.trim();
const price=parseFloat(document.getElementById('new-prod-price').value);
const desc=document.getElementById('new-prod-desc').value.trim();
const category=document.getElementById('new-prod-cat').value;
const selIcon=document.querySelector('#new-prod-icons img.selected');
if(!name||isNaN(price)||!desc||!category||!selIcon){alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è"); return;}
products.push({name:name,price:price,desc:desc,category:category,icon:selIcon.src});
document.getElementById('new-prod-name').value=''; document.getElementById('new-prod-price').value=''; document.getElementById('new-prod-desc').value='';
saveData();
alert("–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω");
}

function saveData(){
localStorage.setItem('categories',JSON.stringify(categories)); 
localStorage.setItem('products',JSON.stringify(products)); 
renderCategories(); renderProducts(); renderAdminCategories(); renderAdminProducts(); populateProdCatSelect(); renderCart();
}

function renderAdminCategories(){
const container=document.getElementById('admin-categories'); container.innerHTML='';
categories.forEach((c,i)=>{
const div=document.createElement('div'); div.innerText=c.name;
const btn=document.createElement('button'); btn.innerText='–£–¥–∞–ª–∏—Ç—å'; btn.className='delete-btn';
btn.onclick=()=>{if(confirm("–£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é? –í—Å–µ —Ç–æ–≤–∞—Ä—ã —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–∂–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.")){
products=products.filter(p=>p.category!==c.name);
cart=cart.filter(p=>p.category!==c.name);
categories.splice(i,1); saveData();}};
div.appendChild(btn); container.appendChild(div);
});
}

function renderAdminProducts(){
const container=document.getElementById('admin-products'); container.innerHTML='';
products.forEach((p,i)=>{
const div=document.createElement('div'); div.innerText=`${p.name} - ${p.price} ‚ÇΩ [${p.category}]`;
const btn=document.createElement('button'); btn.innerText='–£–¥–∞–ª–∏—Ç—å'; btn.className='delete-btn';
btn.onclick=()=>{if(confirm("–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä?")){products.splice(i,1);cart=cart.filter(x=>x!==p); saveData();}};
div.appendChild(btn); container.appendChild(div);
});
}

// ===== –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è =====
setupIconSelect('new-cat-icons'); setupIconSelect('new-prod-icons'); saveData(); renderCart();
</script>
</body>
</html>
